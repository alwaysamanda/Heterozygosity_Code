host: login-p-1
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 56
Rules claiming more threads will be scaled down.
Job stats:
job                      count
---------------------  -------
CALC_HET_PER_CHR             3
CALC_HET_WHOLE_GENOME        1
COMPILE_HET                  1
FROH_PER_AUT_CHR             8
PLOT_HET_PER_CHR            46
PLOT_WHOLE_HET               1
Plot_ROH                     1
WHOLE_FROH                   1
all                          1
total                       63

Select jobs to execute...
Execute 13 jobs...

[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068640.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068640.1_GCA_035084215.1_FROH.txt
    jobid: 156
    reason: Missing output files: sharks/HepPer/20250422_CM068640.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068640.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068665.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068665.1_GCA_035084215.1_FROH.txt
    jobid: 181
    reason: Missing output files: sharks/HepPer/20250422_CM068665.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068665.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068682.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068682.1_GCA_035084215.1_FROH.txt
    jobid: 198
    reason: Missing output files: sharks/HepPer/20250422_CM068682.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068682.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068658.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068658.1_GCA_035084215.1_FROH.txt
    jobid: 174
    reason: Missing output files: sharks/HepPer/20250422_CM068658.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068658.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068659.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068659.1_GCA_035084215.1_FROH.txt
    jobid: 175
    reason: Missing output files: sharks/HepPer/20250422_CM068659.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068659.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068637.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068637.1_GCA_035084215.1_FROH.txt
    jobid: 153
    reason: Missing output files: sharks/HepPer/20250422_CM068637.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068637.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068639.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068639.1_GCA_035084215.1_FROH.txt
    jobid: 155
    reason: Missing output files: sharks/HepPer/20250422_CM068639.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068639.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule FROH_PER_AUT_CHR:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/20250422_CM068666.1_Var_Only.txt
    output: sharks/HepPer/20250422_CM068666.1_GCA_035084215.1_FROH.txt
    jobid: 182
    reason: Missing output files: sharks/HepPer/20250422_CM068666.1_GCA_035084215.1_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068666.1, REF_NAME=GCA_035084215.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule WHOLE_FROH:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/HepPer_Var_Only.txt
    output: sharks/HepPer/20250422_HepPer_FROH.txt
    jobid: 199
    reason: Missing output files: sharks/HepPer/20250422_HepPer_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule Plot_ROH:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt
    output: sharks/HepPer/20250422_HepPer_ROH_Map.pdf
    jobid: 152
    reason: Missing output files: sharks/HepPer/20250422_HepPer_ROH_Map.pdf
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068654.1_het.txt
    jobid: 217
    reason: Missing output files: sharks/HepPer/20250422_CM068654.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068654.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068647.1_het.txt
    jobid: 210
    reason: Missing output files: sharks/HepPer/20250422_CM068647.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068647.1
    resources: tmpdir=/tmp


[Wed Apr 23 22:42:29 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068640.1_het.txt
    jobid: 203
    reason: Missing output files: sharks/HepPer/20250422_CM068640.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068640.1
    resources: tmpdir=/tmp

[Wed Apr 23 22:42:32 2025]
Finished job 198.
1 of 63 steps (2%) done
[Wed Apr 23 22:42:32 2025]
Finished job 174.
2 of 63 steps (3%) done
[Wed Apr 23 22:42:32 2025]
Finished job 181.
3 of 63 steps (5%) done
[Wed Apr 23 22:42:32 2025]
Finished job 155.
4 of 63 steps (6%) done
[Wed Apr 23 22:42:32 2025]
Finished job 182.
5 of 63 steps (8%) done
[Wed Apr 23 22:42:32 2025]
Finished job 175.
6 of 63 steps (10%) done
[Wed Apr 23 22:42:32 2025]
Finished job 156.
7 of 63 steps (11%) done
[Wed Apr 23 22:42:32 2025]
Finished job 153.
8 of 63 steps (13%) done
[Wed Apr 23 22:42:34 2025]
Finished job 152.
9 of 63 steps (14%) done
RuleException:
CalledProcessError in file /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/Snakefile, line 390:
Command 'set -euo pipefail;  
        set -e 
        
        Laut_autosomal=0
        Laut=0

        while read -r line; do
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut_autosomal=$(("$Laut_autosomal" + "$chrom_length"))
        done < <(head -n 45 "sharks/chrom_lists/GCA_035084215.1_chroms.txt") 

        while read -r line; do
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut=$(("$Laut" + "$chrom_length"))
        done < "sharks/chrom_lists/GCA_035084215.1_chroms.txt"

        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250106_FROH_Calc.R sharks/HepPer/HepPer_ROH_Results.csv sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt 20250422 GCA_035084215.1 sharks "$Laut" 45 "$Laut_autosomal" > sharks/HepPer/20250422_HepPer_FROH.txt' returned non-zero exit status 1.
[Wed Apr 23 22:42:34 2025]
Error in rule WHOLE_FROH:
    jobid: 199
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/HepPer_Var_Only.txt
    output: sharks/HepPer/20250422_HepPer_FROH.txt
    shell:
        
        set -e 
        
        Laut_autosomal=0
        Laut=0

        while read -r line; do
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut_autosomal=$(("$Laut_autosomal" + "$chrom_length"))
        done < <(head -n 45 "sharks/chrom_lists/GCA_035084215.1_chroms.txt") 

        while read -r line; do
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut=$(("$Laut" + "$chrom_length"))
        done < "sharks/chrom_lists/GCA_035084215.1_chroms.txt"

        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250106_FROH_Calc.R sharks/HepPer/HepPer_ROH_Results.csv sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt 20250422 GCA_035084215.1 sharks "$Laut" 45 "$Laut_autosomal" > sharks/HepPer/20250422_HepPer_FROH.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

RuleException:
CalledProcessError in file /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/Snakefile, line 433:
Command 'set -euo pipefail;  
        python /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250325_find_het_per_chr_V3.py sharks/HepPer/temp/HepPer_Var_Only.txt sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt sharks HepPer 20250422 1000000 500000 45 sharks/HepPer/HepPer_ROH_Results.csv' returned non-zero exit status 1.
[Wed Apr 23 22:45:35 2025]
Error in rule CALC_HET_PER_CHR:
    jobid: 210
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068647.1_het.txt
    shell:
        
        python /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250325_find_het_per_chr_V3.py sharks/HepPer/temp/HepPer_Var_Only.txt sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt sharks HepPer 20250422 1000000 500000 45 sharks/HepPer/HepPer_ROH_Results.csv
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job CALC_HET_PER_CHR since they might be corrupted:
sharks/HepPer/20250422_CM068647.1_het.txt
RuleException:
CalledProcessError in file /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/Snakefile, line 433:
Command 'set -euo pipefail;  
        python /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250325_find_het_per_chr_V3.py sharks/HepPer/temp/HepPer_Var_Only.txt sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt sharks HepPer 20250422 1000000 500000 45 sharks/HepPer/HepPer_ROH_Results.csv' returned non-zero exit status 1.
[Wed Apr 23 22:45:39 2025]
Error in rule CALC_HET_PER_CHR:
    jobid: 203
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068640.1_het.txt
    shell:
        
        python /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250325_find_het_per_chr_V3.py sharks/HepPer/temp/HepPer_Var_Only.txt sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt sharks HepPer 20250422 1000000 500000 45 sharks/HepPer/HepPer_ROH_Results.csv
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job CALC_HET_PER_CHR since they might be corrupted:
sharks/HepPer/20250422_CM068640.1_het.txt
RuleException:
CalledProcessError in file /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/Snakefile, line 433:
Command 'set -euo pipefail;  
        python /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250325_find_het_per_chr_V3.py sharks/HepPer/temp/HepPer_Var_Only.txt sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt sharks HepPer 20250422 1000000 500000 45 sharks/HepPer/HepPer_ROH_Results.csv' returned non-zero exit status 1.
[Wed Apr 23 22:45:41 2025]
Error in rule CALC_HET_PER_CHR:
    jobid: 217
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068654.1_het.txt
    shell:
        
        python /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250325_find_het_per_chr_V3.py sharks/HepPer/temp/HepPer_Var_Only.txt sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt sharks HepPer 20250422 1000000 500000 45 sharks/HepPer/HepPer_ROH_Results.csv
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job CALC_HET_PER_CHR since they might be corrupted:
sharks/HepPer/20250422_CM068654.1_het.txt
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-04-23T224222.462524.snakemake.log
WorkflowError:
At least one job did not complete successfully.

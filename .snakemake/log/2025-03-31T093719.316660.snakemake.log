host: login-q-4
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 76
Rules claiming more threads will be scaled down.
Job stats:
job                      count
---------------------  -------
CALC_HET_WHOLE_GENOME        1
PAF_DOTPLOT                  1
PLOT_HET_PER_CHR             5
PLOT_WHOLE_HET               1
WHOLE_FROH                   1
all                          1
total                       10

Select jobs to execute...
Execute 9 jobs...

[Mon Mar 31 09:37:19 2025]
localrule PLOT_HET_PER_CHR:
    input: sharks/HydCol_Test/HydCol_Test_Het_Compiled.tsv
    output: sharks/HydCol_Test/20250326_HydCol_Test_CM068745.1_Het_Map.svg
    jobid: 52
    reason: Params have changed since last execution: Union of exclusive params before and now across all output: before: 40 now: 5 
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326, CHR=CM068745.1
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule PLOT_WHOLE_HET:
    input: sharks/HydCol_Test/HydCol_Test_Het_Compiled.tsv
    output: sharks/HydCol_Test/20250326_HydCol_Test_Het_Whole_Genome_Map.svg
    jobid: 54
    reason: Params have changed since last execution: Union of exclusive params before and now across all output: before: 40 now: 5 
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule CALC_HET_WHOLE_GENOME:
    input: sharks/HydCol_Test/Reference_HydCol_Test_Chroms_Lengths.txt
    output: sharks/HydCol_Test/20250326_HydCol_Test_per_chr_mean_heterozygosity.txt, sharks/HydCol_Test/20250326_HydCol_Test_whole_genome_mean_heterozygosity.txt
    jobid: 47
    reason: Missing output files: sharks/HydCol_Test/20250326_HydCol_Test_per_chr_mean_heterozygosity.txt, sharks/HydCol_Test/20250326_HydCol_Test_whole_genome_mean_heterozygosity.txt
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule PAF_DOTPLOT:
    input: sharks/chrom_lists/GCA_035084275.1_chroms.txt, sharks/HydCol_Test/HydCol_Test_FASTGA.paf
    output: sharks/HydCol_Test/dotplots/20250326_HydCol_Test_DotPlot.pdf
    jobid: 58
    reason: Missing output files: sharks/HydCol_Test/dotplots/20250326_HydCol_Test_DotPlot.pdf
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule PLOT_HET_PER_CHR:
    input: sharks/HydCol_Test/HydCol_Test_Het_Compiled.tsv
    output: sharks/HydCol_Test/20250326_HydCol_Test_CM068742.1_Het_Map.svg
    jobid: 49
    reason: Params have changed since last execution: Union of exclusive params before and now across all output: before: 40 now: 5 
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326, CHR=CM068742.1
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule PLOT_HET_PER_CHR:
    input: sharks/HydCol_Test/HydCol_Test_Het_Compiled.tsv
    output: sharks/HydCol_Test/20250326_HydCol_Test_CM068744.1_Het_Map.svg
    jobid: 51
    reason: Params have changed since last execution: Union of exclusive params before and now across all output: before: 40 now: 5 
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326, CHR=CM068744.1
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule PLOT_HET_PER_CHR:
    input: sharks/HydCol_Test/HydCol_Test_Het_Compiled.tsv
    output: sharks/HydCol_Test/20250326_HydCol_Test_CM068746.1_Het_Map.svg
    jobid: 53
    reason: Params have changed since last execution: Union of exclusive params before and now across all output: before: 40 now: 5 
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326, CHR=CM068746.1
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule WHOLE_FROH:
    input: sharks/HydCol_Test/HydCol_Test_ROH_Results.csv, sharks/HydCol_Test/Reference_HydCol_Test_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084275.1_chroms.txt, sharks/HydCol_Test/temp/HydCol_Test_Var_Only.txt
    output: sharks/HydCol_Test/20250326_HydCol_Test_FROH.txt
    jobid: 40
    reason: Missing output files: sharks/HydCol_Test/20250326_HydCol_Test_FROH.txt
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326
    resources: tmpdir=/tmp


[Mon Mar 31 09:37:19 2025]
localrule PLOT_HET_PER_CHR:
    input: sharks/HydCol_Test/HydCol_Test_Het_Compiled.tsv
    output: sharks/HydCol_Test/20250326_HydCol_Test_CM068743.1_Het_Map.svg
    jobid: 50
    reason: Params have changed since last execution: Union of exclusive params before and now across all output: before: 40 now: 5 
    wildcards: CLADE=sharks, SPEC_NAME=HydCol_Test, TODAY_DATE=20250326, CHR=CM068743.1
    resources: tmpdir=/tmp

RuleException:
CalledProcessError in file /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/Snakefile, line 364:
Command 'set -euo pipefail;  
        Laut_autosomal=0
        Laut=0

        while read -r line; do
            start="$(head -n 1 sharks/HydCol_Test/20250326_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HydCol_Test/20250326_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut_autosomal=$(("$Laut_autosomal" + "$chrom_length"))
        done < <(head -n 5 "sharks/chrom_lists/GCA_035084275.1_chroms.txt") 


        start="$(head -n  1 sharks/HydCol_Test/temp/HydCol_Test_Var_Only.txt | awk ' {print $3} ')"
        end="$(tail -n  1 sharks/HydCol_Test/temp/HydCol_Test_Var_Only.txt | awk ' {print $4} ')"
        chrom_length="$((end - start))"
        Laut="$("$Laut" + "$chrom_length")"

        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250106_FROH_Calc.R sharks/HydCol_Test/HydCol_Test_ROH_Results.csv sharks/HydCol_Test/Reference_HydCol_Test_Chroms_Lengths.txt 20250326 GCA_035084275.1 sharks "$Laut" 5 "$Laut_autosomal" > sharks/HydCol_Test/20250326_HydCol_Test_FROH.txt' returned non-zero exit status 1.
[Mon Mar 31 09:37:20 2025]
Error in rule WHOLE_FROH:
    jobid: 40
    input: sharks/HydCol_Test/HydCol_Test_ROH_Results.csv, sharks/HydCol_Test/Reference_HydCol_Test_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084275.1_chroms.txt, sharks/HydCol_Test/temp/HydCol_Test_Var_Only.txt
    output: sharks/HydCol_Test/20250326_HydCol_Test_FROH.txt
    shell:
        
        Laut_autosomal=0
        Laut=0

        while read -r line; do
            start="$(head -n 1 sharks/HydCol_Test/20250326_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HydCol_Test/20250326_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut_autosomal=$(("$Laut_autosomal" + "$chrom_length"))
        done < <(head -n 5 "sharks/chrom_lists/GCA_035084275.1_chroms.txt") 


        start="$(head -n  1 sharks/HydCol_Test/temp/HydCol_Test_Var_Only.txt | awk ' {print $3} ')"
        end="$(tail -n  1 sharks/HydCol_Test/temp/HydCol_Test_Var_Only.txt | awk ' {print $4} ')"
        chrom_length="$((end - start))"
        Laut="$("$Laut" + "$chrom_length")"

        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250106_FROH_Calc.R sharks/HydCol_Test/HydCol_Test_ROH_Results.csv sharks/HydCol_Test/Reference_HydCol_Test_Chroms_Lengths.txt 20250326 GCA_035084275.1 sharks "$Laut" 5 "$Laut_autosomal" > sharks/HydCol_Test/20250326_HydCol_Test_FROH.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Mon Mar 31 09:37:20 2025]
Finished job 47.
1 of 10 steps (10%) done
[Mon Mar 31 09:37:21 2025]
Finished job 54.
2 of 10 steps (20%) done
[Mon Mar 31 09:37:21 2025]
Finished job 53.
3 of 10 steps (30%) done
[Mon Mar 31 09:37:21 2025]
Finished job 51.
4 of 10 steps (40%) done
[Mon Mar 31 09:37:21 2025]
Finished job 50.
5 of 10 steps (50%) done
[Mon Mar 31 09:37:21 2025]
Finished job 49.
6 of 10 steps (60%) done
[Mon Mar 31 09:37:21 2025]
Finished job 52.
7 of 10 steps (70%) done
RuleException:
CalledProcessError in file /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/Snakefile, line 519:
Command 'set -euo pipefail;  
        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250212_pafr_dotplot.R sharks HydCol_Test 20250326 sharks/HydCol_Test/dotplots sharks/chrom_lists/GCA_035084275.1_chroms.txt sharks/HydCol_Test/HydCol_Test_FASTGA.paf' returned non-zero exit status 1.
[Mon Mar 31 09:39:03 2025]
Error in rule PAF_DOTPLOT:
    jobid: 58
    input: sharks/chrom_lists/GCA_035084275.1_chroms.txt, sharks/HydCol_Test/HydCol_Test_FASTGA.paf
    output: sharks/HydCol_Test/dotplots/20250326_HydCol_Test_DotPlot.pdf
    shell:
        
        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250212_pafr_dotplot.R sharks HydCol_Test 20250326 sharks/HydCol_Test/dotplots sharks/chrom_lists/GCA_035084275.1_chroms.txt sharks/HydCol_Test/HydCol_Test_FASTGA.paf
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-03-31T093719.316660.snakemake.log
WorkflowError:
At least one job did not complete successfully.

host: login-p-3
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 56
Rules claiming more threads will be scaled down.
Job stats:
job                      count
---------------------  -------
CALC_HET_PER_CHR            34
CALC_HET_WHOLE_GENOME        1
COMPILE_HET                  1
PLOT_HET_PER_CHR            46
PLOT_WHOLE_HET               1
WHOLE_FROH                   1
all                          1
total                       85

Select jobs to execute...
Execute 35 jobs...

[Thu Apr 24 09:35:14 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068641.1_het.txt
    jobid: 204
    reason: Missing output files: sharks/HepPer/20250422_CM068641.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068641.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:14 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068677.1_het.txt
    jobid: 240
    reason: Missing output files: sharks/HepPer/20250422_CM068677.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068677.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:14 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068670.1_het.txt
    jobid: 233
    reason: Missing output files: sharks/HepPer/20250422_CM068670.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068670.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068663.1_het.txt
    jobid: 226
    reason: Missing output files: sharks/HepPer/20250422_CM068663.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068663.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068656.1_het.txt
    jobid: 219
    reason: Missing output files: sharks/HepPer/20250422_CM068656.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068656.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068678.1_het.txt
    jobid: 241
    reason: Missing output files: sharks/HepPer/20250422_CM068678.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068678.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068671.1_het.txt
    jobid: 234
    reason: Missing output files: sharks/HepPer/20250422_CM068671.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068671.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068664.1_het.txt
    jobid: 227
    reason: Missing output files: sharks/HepPer/20250422_CM068664.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068664.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068657.1_het.txt
    jobid: 220
    reason: Missing output files: sharks/HepPer/20250422_CM068657.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068657.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068650.1_het.txt
    jobid: 213
    reason: Missing output files: sharks/HepPer/20250422_CM068650.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068650.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068643.1_het.txt
    jobid: 206
    reason: Missing output files: sharks/HepPer/20250422_CM068643.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068643.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule WHOLE_FROH:
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/HepPer_Var_Only.txt
    output: sharks/HepPer/20250422_HepPer_FROH.txt
    jobid: 199
    reason: Missing output files: sharks/HepPer/20250422_HepPer_FROH.txt; Code has changed since last execution; Params have changed since last execution: Union of exclusive params before and now across all output: before: 44 now: 45 
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068679.1_het.txt
    jobid: 242
    reason: Missing output files: sharks/HepPer/20250422_CM068679.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068679.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068672.1_het.txt
    jobid: 235
    reason: Missing output files: sharks/HepPer/20250422_CM068672.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068672.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068665.1_het.txt
    jobid: 228
    reason: Missing output files: sharks/HepPer/20250422_CM068665.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068665.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068658.1_het.txt
    jobid: 221
    reason: Missing output files: sharks/HepPer/20250422_CM068658.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068658.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068651.1_het.txt
    jobid: 214
    reason: Missing output files: sharks/HepPer/20250422_CM068651.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068651.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068644.1_het.txt
    jobid: 207
    reason: Missing output files: sharks/HepPer/20250422_CM068644.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068644.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068637.1_het.txt
    jobid: 200
    reason: Missing output files: sharks/HepPer/20250422_CM068637.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068637.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068680.1_het.txt
    jobid: 243
    reason: Missing output files: sharks/HepPer/20250422_CM068680.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068680.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068666.1_het.txt
    jobid: 229
    reason: Missing output files: sharks/HepPer/20250422_CM068666.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068666.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068659.1_het.txt
    jobid: 222
    reason: Missing output files: sharks/HepPer/20250422_CM068659.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068659.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068652.1_het.txt
    jobid: 215
    reason: Missing output files: sharks/HepPer/20250422_CM068652.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068652.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068681.1_het.txt
    jobid: 244
    reason: Missing output files: sharks/HepPer/20250422_CM068681.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068681.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068660.1_het.txt
    jobid: 223
    reason: Missing output files: sharks/HepPer/20250422_CM068660.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068660.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068653.1_het.txt
    jobid: 216
    reason: Missing output files: sharks/HepPer/20250422_CM068653.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068653.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068682.1_het.txt
    jobid: 245
    reason: Missing output files: sharks/HepPer/20250422_CM068682.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068682.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068668.1_het.txt
    jobid: 231
    reason: Missing output files: sharks/HepPer/20250422_CM068668.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068668.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:15 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068661.1_het.txt
    jobid: 224
    reason: Missing output files: sharks/HepPer/20250422_CM068661.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068661.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:16 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068654.1_het.txt
    jobid: 217
    reason: Missing output files: sharks/HepPer/20250422_CM068654.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068654.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:16 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068647.1_het.txt
    jobid: 210
    reason: Missing output files: sharks/HepPer/20250422_CM068647.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068647.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:16 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068640.1_het.txt
    jobid: 203
    reason: Missing output files: sharks/HepPer/20250422_CM068640.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068640.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:16 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068676.1_het.txt
    jobid: 239
    reason: Missing output files: sharks/HepPer/20250422_CM068676.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068676.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:16 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068662.1_het.txt
    jobid: 225
    reason: Missing output files: sharks/HepPer/20250422_CM068662.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068662.1
    resources: tmpdir=/tmp


[Thu Apr 24 09:35:16 2025]
localrule CALC_HET_PER_CHR:
    input: sharks/HepPer/temp/HepPer_Var_Only.txt, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/HepPer/HepPer_ROH_Results.csv
    output: sharks/HepPer/20250422_CM068655.1_het.txt
    jobid: 218
    reason: Missing output files: sharks/HepPer/20250422_CM068655.1_het.txt
    wildcards: CLADE=sharks, SPEC_NAME=HepPer, TODAY_DATE=20250422, CHR=CM068655.1
    resources: tmpdir=/tmp

RuleException:
CalledProcessError in file /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/Snakefile, line 389:
Command 'set -euo pipefail;  
        set -e 
        
        Laut_autosomal=0
        Laut=0

        while read -r line; do
            echo "$line"
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut_autosomal=$(("$Laut_autosomal" + "$chrom_length"))
        done < <(head -n 45 "sharks/chrom_lists/GCA_035084215.1_chroms.txt") 

        while read -r line; do
            echo "$line"
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut=$(("$Laut" + "$chrom_length"))
        done < "sharks/chrom_lists/GCA_035084215.1_chroms.txt"

        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250106_FROH_Calc.R sharks/HepPer/HepPer_ROH_Results.csv sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt 20250422 GCA_035084215.1 sharks "$Laut" 45 "$Laut_autosomal" > sharks/HepPer/20250422_HepPer_FROH.txt' returned non-zero exit status 1.
[Thu Apr 24 09:35:30 2025]
Error in rule WHOLE_FROH:
    jobid: 199
    input: sharks/HepPer/HepPer_ROH_Results.csv, sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt, sharks/chrom_lists/GCA_035084215.1_chroms.txt, sharks/HepPer/temp/HepPer_Var_Only.txt
    output: sharks/HepPer/20250422_HepPer_FROH.txt
    shell:
        
        set -e 
        
        Laut_autosomal=0
        Laut=0

        while read -r line; do
            echo "$line"
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut_autosomal=$(("$Laut_autosomal" + "$chrom_length"))
        done < <(head -n 45 "sharks/chrom_lists/GCA_035084215.1_chroms.txt") 

        while read -r line; do
            echo "$line"
            start="$(head -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $3} ')"
            end="$(tail -n 1 sharks/HepPer/temp/20250422_"$line"_Var_Only.txt | awk ' {print $4} ')"
            chrom_length="$((end - start))"
            Laut=$(("$Laut" + "$chrom_length"))
        done < "sharks/chrom_lists/GCA_035084215.1_chroms.txt"

        Rscript /rds/project/rds-p67MZilb2eQ/projects/VGP/heterozygosity/20250106_FROH_Calc.R sharks/HepPer/HepPer_ROH_Results.csv sharks/HepPer/Reference_HepPer_Chroms_Lengths.txt 20250422 GCA_035084215.1 sharks "$Laut" 45 "$Laut_autosomal" > sharks/HepPer/20250422_HepPer_FROH.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

